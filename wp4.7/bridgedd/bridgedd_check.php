<?php
/*
	BridgeDD Check
	Copyright  2016 by Dion Designs.
	All Rights Reserved.
*/
define('IN_PHPBB', true); define('SERVER_DOCUMENT_ROOT', substr(getenv('SCRIPT_FILENAME'), 0, strpos(getenv('SCRIPT_FILENAME'), getenv('SCRIPT_NAME')))); $phpbb_root_path = SERVER_DOCUMENT_ROOT . $_GET['path']; $phpEx = substr(strrchr(__FILE__, '.'), 1); header('Content-Type: text/html'); header('Pragma: no-cache'); header('Cache-Control: private, no-cache="set-cookie"'); header('Expires: 0'); if (!isset($_GET['path'])) { die('[NO PATH]'); } else if (!is_dir($phpbb_root_path)) { die('[INVALID PATH]'); } else if (!file_exists($phpbb_root_path . 'common.' . $phpEx)) { die('[PHPBB NOT FOUND]'); } $teststr = true; $test2 = false; $testfile = "{$phpbb_root_path}faq.{$phpEx}"; $test = @file_get_contents($testfile); if ($test) { $teststr = str_replace("define('IN_PHPBB'", "\t\tdefine('IN_PHPBB'", $test); @file_put_contents($testfile, $teststr); clearstatcache(); $test2 = @file_get_contents($testfile); } if ($test2 == $teststr) { @file_put_contents($testfile, $test); clearstatcache(); } else { die('[CANNOT MODIFY PHPBB]'); } error_reporting(5111); set_error_handler('no_error_handler'); @ini_set('open_basedir', ''); require($phpbb_root_path . 'common.' . $phpEx); if (!defined('PHPBB_INSTALLED')) { die('[CANNOT LOAD PHPBB]'); } else if (strpos($dbms, 'mysql') === false) { die('[DBMS NOT MYSQL]'); } else if (strpos($acm_type, 'file') === false) { die('[ACM NOT FILE]'); } else if (empty($config['version']) || empty($config['server_protocol']) || empty($config['server_name'])) { die('[CONFIG ERROR]'); } else if (version_compare($config['version'], '3.0.9', '<')) { die('[BAD PHPBB VERSION]'); } $port = (!empty($config['server_port']) && $config['server_port'] != 80 && $config['server_port'] != 443) ? ":{$config['server_port']}" : ''; echo "||OK{$config['server_protocol']}{$config['server_name']}{$port}{$config['script_path']}/index.php"; exit; function no_error_handler($errno = 0, $errstr = '', $errfile = '', $errline = '') { if (!(5111 & $errno)) { return; } die('[CANNOT FIND PHPBB]'); }